==============================================
이동속도별 공기방울 효과 시스템 설정 가이드
==============================================

작성일: 2025-01-23
버전: 1.0
대상: Unity 개발자, 게임 디자이너

==============================================
1. 개요
==============================================

이 시스템은 플레이어의 이동속도에 따라 발 뒤에서 발생하는 공기방울의 양과 크기를 
동적으로 변화시켜 직관적인 속도 피드백을 제공합니다.

주요 기능:
- 5단계 속도별 차별화된 공기방울 효과
- 실시간 속도 감지 및 스무딩
- 물리 기반 공기방울 시뮬레이션
- 물 위/아래 자동 감지

==============================================
2. 시스템 구성 요소
==============================================

2.1 핵심 스크립트
├── BubbleEffectManager.cs      (메인 관리자)
├── BubbleController.cs         (개별 공기방울 제어)
├── PlayerSpeedDetector.cs      (속도 감지)
└── BubbleSpeedConfig.cs        (설정 구조체)

2.2 프리팹
└── bubble.prefab               (기존 공기방울 프리팹 활용)

==============================================
3. 설치 및 설정 방법
==============================================

3.1 Player 오브젝트에 컴포넌트 추가

1) Player 오브젝트 선택
2) BubbleEffectManager 컴포넌트 추가
3) PlayerSpeedDetector 컴포넌트 추가 (자동 추가됨)

3.2 BubbleEffectManager 설정

[공기방울 프리팹]
- Bubble Prefab: bubble 프리팹 할당 (기존 프리팹 사용, BubbleController 자동 추가됨)

[발생 위치]
- Left Foot Transform: 왼발 위치 Transform 할당
- Right Foot Transform: 오른발 위치 Transform 할당
  (없으면 플레이어 중심에서 발생)

[기본 설정]
- Enable Bubble Effect: 효과 활성화 여부 (기본: true)
- Emission Interval: 발생 간격 (기본: 0.1초)

3.3 속도별 설정 (Speed Configs)

5개의 속도 구간별 설정이 자동으로 초기화됩니다:

구간 0 - 정지 (0~0.5)
- 발생률: 2개/초
- 크기: 0.1~0.2
- 수명: 1.5초
- 색상: 반투명 흰색

구간 1 - 느림 (0.5~3)
- 발생률: 5개/초
- 크기: 0.2~0.4
- 수명: 2초
- 색상: 흰색 (투명도 50%)

구간 2 - 보통 (3~6)
- 발생률: 8개/초
- 크기: 0.4~0.6
- 수명: 2.5초
- 색상: 흰색 (투명도 70%)

구간 3 - 빠름 (6~9)
- 발생률: 12개/초
- 크기: 0.6~0.8
- 수명: 3초
- 색상: 흰색 (투명도 90%)

구간 4 - 최고속 (9+)
- 발생률: 20개/초
- 크기: 0.8~1.2
- 수명: 3.5초
- 색상: 완전 불투명 흰색
- 특수 효과: 반짝임, 물결 효과

==============================================
4. 커스터마이징 방법
==============================================

4.1 속도 구간 조정

BubbleEffectManager의 InitializeDefaultConfigs() 메서드에서
각 구간의 minSpeed, maxSpeed 값을 수정:

```csharp
speedConfigs[0].minSpeed = 0f;
speedConfigs[0].maxSpeed = 1f;  // 정지 구간을 0~1로 변경
```

4.2 공기방울 외관 커스터마이징

각 속도 구간별로 다음 속성들을 조정할 수 있습니다:

- emissionRate: 초당 발생 개수
- minSize/maxSize: 크기 범위
- lifetime: 지속 시간
- bubbleColor: 색상 (RGBA)
- alphaMultiplier: 투명도 배수
- hasSparkleEffect: 반짝임 효과 여부
- hasWaveEffect: 물결 효과 여부

4.3 물리 속성 조정

BubbleController.cs에서 다음 값들을 조정:

```csharp
public float leftwardForce = 2f;        // 왼쪽 이동 힘
public float waterResistance = 0.5f;    // 물 저항
public float randomMovement = 0.3f;     // 랜덤 움직임
```

==============================================
5. 프리팹 설정 방법
==============================================

5.1 bubble 프리팹 활용

기존 bubble.prefab을 사용하며, BubbleController 컴포넌트는 런타임에 자동으로 추가됩니다.

기본 구성 컴포넌트:
- Transform
- SpriteRenderer (공기방울 스프라이트)
- Rigidbody2D (물리 시뮬레이션)
- BubbleController (런타임 자동 추가)

5.2 Rigidbody2D 권장 설정

- Mass: 0.1 (가벼움)
- Linear Drag: 2 (물 저항)
- Angular Drag: 0.05
- Gravity Scale: 0 (중력 비활성화, 왼쪽 이동만)
- Interpolate: Interpolate (부드러운 움직임)

5.3 SpriteRenderer 권장 설정

- Sorting Order: 10 (다른 오브젝트 위에 표시)
- Color: 흰색, 투명도 70%
- 스프라이트: 원형 또는 타원형 공기방울 이미지

==============================================
6. 디버깅 및 테스트
==============================================

6.1 디버그 정보 확인

게임 실행 중 화면 왼쪽 상단에 다음 정보가 표시됩니다:
- Current Speed: 현재 속도
- Underwater: 물 속 여부

6.2 테스트 버튼

BubbleEffectManager Inspector에서 "Test Bubble Effect" 버튼을 
클릭하여 공기방울 효과를 즉시 테스트할 수 있습니다.

6.3 속도 감지 조정

PlayerSpeedDetector에서 다음 값들을 조정하여 속도 감지를 튜닝:

- Speed Smooth Time: 속도 스무딩 시간 (기본: 0.1초)
- Speed Sample Count: 속도 샘플 개수 (기본: 5개)

==============================================
7. 성능 최적화
==============================================

7.1 공기방울 수명 관리

- 각 공기방울은 설정된 lifetime 후 자동 제거됩니다
- 화면 밖으로 나간 공기방울은 추가 제거 로직 없이 자연 소멸

7.2 발생률 조정

너무 많은 공기방울이 생성되면 성능에 영향을 줄 수 있으므로:
- emissionRate 값을 적절히 조정
- emissionInterval을 늘려서 발생 빈도 조절

7.3 물 위에서 자동 비활성화

플레이어가 물 위에 있을 때는 공기방울 생성이 자동으로 중단됩니다.

==============================================
8. 문제 해결
==============================================

8.1 공기방울이 생성되지 않는 경우

1) BubbleEffectManager가 Player에 추가되었는지 확인
2) bubblePrefab이 할당되었는지 확인
3) enableBubbleEffect가 true인지 확인
4) 플레이어가 물 속에 있는지 확인 (isUnderwater = true)

8.2 속도 감지가 부정확한 경우

1) PlayerSpeedDetector의 smoothTime 값을 조정
2) speedSampleCount를 늘려서 더 안정적인 평균값 계산
3) Player의 이동 코드와의 호환성 확인

8.3 공기방울이 이상하게 움직이는 경우

1) BubbleController의 물리 설정값 조정
2) Rigidbody2D의 Mass, Drag 값 확인
3) buoyancyForce, waterResistance 값 튜닝

==============================================
9. 확장 가능성
==============================================

9.1 레벨별 색상 변화
- 게임 진행도에 따른 공기방울 색상 변경
- 특수 아이템 사용 시 색상 효과

9.2 특수 장비 효과
- 수영복, 오리발 등 장비에 따른 공기방울 패턴 변화
- 속도 부스터 아이템 사용 시 특별한 공기방울 효과

9.3 환경 연동
- 물의 깊이에 따른 공기방울 크기 변화
- 물 온도, 염분 농도 등에 따른 효과 변화

==============================================
10. 업데이트 이력
==============================================

v1.0 (2025-01-23)
- 초기 시스템 구현
- 5단계 속도별 차별화 효과
- 물리 기반 공기방울 시뮬레이션
- 자동 물 위/아래 감지 기능

==============================================
문의 및 지원
==============================================

시스템 관련 문의사항이 있으시면 개발팀에 연락해주세요.
이 가이드는 게임 개발 진행에 따라 지속적으로 업데이트됩니다. 